#!/usr/bin/env bash
# toggle the xdebug module in php.ini

# include some nice messaging functions
source functions.sh

if [[ $EUID -ne 0 ]]; then
    write_error "This script must be run as root"
    exit 1
fi

PHP_INI=/etc/php/php.ini
if [ $(grep -c '^zend_extension=/usr/lib/php/modules/xdebug.so' $PHP_INI) -gt 0 ]; then
    sed -i "$PHP_INI" -e 's@^\(zend_extension=/usr/lib/php/modules/xdebug.so\)@;\1@'
    write_info "disabled"
else
    sed -i "$PHP_INI" -e 's@^;\(zend_extension=/usr/lib/php/modules/xdebug.so\)@\1@'
    write_info "enabled"
fi

# restart the http service to make the changed to take effect
systemctl restart httpd.service
